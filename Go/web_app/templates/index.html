<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>

  <style>
    #search-results tr:hover {
      background-color: lightgray;
      cursor: pointer;
    }
  </style>

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script>
    function submitSearch() {
      $.ajax({
        url: "/search",
        method: "POST",
        data: $("#search-form").serialize(),
        success: function(rawData) {
          var parsed = JSON.parse(rawData);
          if (!parsed) return;
          var searchResults = $("#search-results"); // Locate the table element
          searchResults.empty(); // and clear them of their contents
          
          parsed.forEach(function(result) {
            var row = $("<tr><td>" + result.Title + "</td><td>" + result.Author + "</td><td>" + result.Year + "</td><td>" + result.ID + "</td></tr>");
            searchResults.append(row);
            row.on("click", function() {
              $.ajax({
                url: "/books/add?id=" + result.ID,
                method: "GET"
              })
            })
          })

        }
      });
      return false //Necessary to stop button default behavior
    }
  </script>
</head>
<body>
  <form id="search-form" onsubmit="return false">
    <input name="search" />
    <input type="submit" value="Search" onclick="submitSearch()"/>
  </form>

  <table width="100%">
    <thead></thead>
      <th width="40%">Title</th>
      <th width="30%">Author</th>
      <th width="10%">Year</th>
      <th width="20%">ID</th>
    <tbody id="search-results"></tbody>
  </table>
</body>
</html>